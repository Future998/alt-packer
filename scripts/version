#! /bin/sh
set -euo pipefail

target=${target:-alt-server}
arch=${arch:-x86_64}
BASE_VERSION=${BASE_VERSION:-9}
TARGET_VERSION=${TARGET_VERSION:-9}
VM_TYPE=${VM_TYPE:-qemu}
VERSION_FILE=${VERSION_FILE:-scripts/build/image-version}
GIT_TAG=${GIT_TAG:-""}
GIT_HASH=${GIT_HASH:-""}
BUILD_DATE=${BUILD_DATE:-""}
BUILD_DATE_FULL=${BUILD_DATE_FULL:-""}
IMAGE_FILENAME=${IMAGE_FILENAME:-""}

rm -rf ${VERSION_FILE}

echo "Image generated by ALT Packer toolkit" >> ${VERSION_FILE}
echo "Github: https://github.com/alt-cloud/alt-packer" >> ${VERSION_FILE}
echo "" >> ${VERSION_FILE}
echo "Name: ${IMAGE_FILENAME}" >> ${VERSION_FILE}
echo "Git hash: ${GIT_HASH}" >> ${VERSION_FILE}
echo "Git tag: ${GIT_TAG}" >> ${VERSION_FILE}
echo "Date: ${BUILD_DATE_FULL}" >> ${VERSION_FILE}
